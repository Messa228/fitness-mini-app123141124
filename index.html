<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Fitness Mini App</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f5f5f5;
}

/* ===== –≠–ö–†–ê–ù–´ ===== */
.screen {
  display: none;
  position: fixed;
  inset: 0;
  padding: 16px;
  background: #f5f5f5;
  overflow-y: auto;
}
.screen.active { display: block; }

/* ===== –ì–õ–ê–í–ù–ê–Ø ===== */
#home {
  display: flex;
  flex-direction: column;
}
.home-btn {
  flex: 1;
  background: white;
  margin-bottom: 10px;
  border-radius: 12px;
  font-size: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

/* ===== –°–ï–ö–¶–ò–ò ===== */
.section {
  background: white;
  border-radius: 12px;
  padding: 12px;
  margin-bottom: 16px;
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.plus {
  font-size: 28px;
  cursor: pointer;
}

/* ===== –ë–õ–Æ–î–ê ===== */
.food-item {
  display: flex;
  align-items: center;
  margin-top: 10px;
}

.food-item input {
  width: 26px;
  height: 26px;
  margin-right: 12px;
}

.food-name {
  font-size: 18px;
  cursor: pointer;
}

/* ===== –í–û–î–ê ===== */
.progress {
  height: 12px;
  background: #ddd;
  border-radius: 6px;
  overflow: hidden;
  margin-top: 8px;
}
.progress-bar {
  height: 100%;
  background: #4CAF50;
  width: 0%;
}

/* ===== –ö–ù–û–ü–ö–ò ===== */
button {
  width: 100%;
  padding: 12px;
  margin-top: 10px;
  font-size: 16px;
}
</style>
</head>

<body>

<!-- ===== –ì–õ–ê–í–ù–ê–Ø ===== -->
<div id="home" class="screen active">
  <div class="home-btn" onclick="openScreen('food')">üçΩ –ï–î–ê</div>
  <div class="home-btn" onclick="openScreen('workout')">üèãÔ∏è –¢–†–ï–ù–ò–†–û–í–ö–ò</div>
  <div class="home-btn" onclick="openScreen('stats')">üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê</div>
</div>

<!-- ===== –ï–î–ê ===== -->
<div id="food" class="screen">
  <h2>–ï–¥–∞</h2>

  <div id="breakfast" class="section">
    <div class="section-header">
      <h3>–ó–∞–≤—Ç—Ä–∞–∫</h3>
      <div class="plus" onclick="addFood('breakfast')">+</div>
    </div>
    <div class="list"></div>
  </div>

  <div id="lunch" class="section">
    <div class="section-header">
      <h3>–û–±–µ–¥</h3>
      <div class="plus" onclick="addFood('lunch')">+</div>
    </div>
    <div class="list"></div>
  </div>

  <div id="dinner" class="section">
    <div class="section-header">
      <h3>–£–∂–∏–Ω</h3>
      <div class="plus" onclick="addFood('dinner')">+</div>
    </div>
    <div class="list"></div>
  </div>

  <!-- –í–û–î–ê -->
  <div class="section">
    <div class="section-header">
      <h3>–í–æ–¥–∞</h3>
      <span onclick="setWaterGoal()">‚úèÔ∏è</span>
    </div>

    <p>–¶–µ–ª—å: <span id="waterGoal">2000</span> –º–ª</p>
    <p>–í—ã–ø–∏—Ç–æ: <span id="waterDone">0</span> –º–ª</p>

    <div class="progress">
      <div id="waterBar" class="progress-bar"></div>
    </div>

    <input type="number" id="waterInput" placeholder="–°–∫–æ–ª—å–∫–æ –≤—ã–ø–∏–ª (–º–ª)">
    <button onclick="addWater()">+</button>
    <button onclick="resetWater()">–°–±—Ä–æ—Å–∏—Ç—å –≤–æ–¥—É</button>
  </div>

  <button onclick="goHome()">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<!-- ===== –ü–£–°–¢–´–ï ===== -->
<div id="workout" class="screen">
  <h2>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h2>
  <button onclick="goHome()">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<div id="stats" class="screen">
  <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
  <button onclick="goHome()">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<script>
Telegram.WebApp.ready();
Telegram.WebApp.expand();

/* –ù–ê–í–ò–ì–ê–¶–ò–Ø */
function openScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}
function goHome() { openScreen('home'); }

/* ===== –ï–î–ê ===== */
let foods = JSON.parse(localStorage.getItem('foods')) || {
  breakfast: [], lunch: [], dinner: []
};

function renderFood() {
  ['breakfast','lunch','dinner'].forEach(type => {
    const list = document.querySelector('#'+type+' .list');
    list.innerHTML = '';
    foods[type].forEach((f,i)=>{
      const div = document.createElement('div');
      div.className = 'food-item';
      div.innerHTML = `
        <input type="checkbox" ${f.done?'checked':''}
          onchange="toggleFood('${type}',${i})">
        <span class="food-name"
          onclick="editFood('${type}',${i})">${f.name}</span>`;
      list.appendChild(div);
    });
  });
  localStorage.setItem('foods', JSON.stringify(foods));
}

function addFood(type) {
  const name = prompt('–ù–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞');
  if (!name) return;
  foods[type].push({name, done:false});
  renderFood();
}

function toggleFood(type,i) {
  foods[type][i].done = !foods[type][i].done;
  renderFood();
}

function editFood(type,i) {
  const action = prompt('1 ‚Äî –∏–∑–º–µ–Ω–∏—Ç—å\n2 ‚Äî —É–¥–∞–ª–∏—Ç—å');
  if (action === '1') {
    const name = prompt('–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ', foods[type][i].name);
    if (name) foods[type][i].name = name;
  }
  if (action === '2') foods[type].splice(i,1);
  renderFood();
}
renderFood();

/* ===== –í–û–î–ê ===== */
let water = Number(localStorage.getItem('water')) || 0;
let goal = Number(localStorage.getItem('goal')) || 2000;

function updateWater() {
  waterGoal.textContent = goal;
  waterDone.textContent = water;
  waterBar.style.width = Math.min(100, water/goal*100) + '%';
  localStorage.setItem('water', water);
  localStorage.setItem('goal', goal);
}

function addWater() {
  const v = Number(waterInput.value);
  if (!v) return;
  water += v;
  waterInput.value='';
  updateWater();
}

function resetWater() {
  water = 0;
  updateWater();
}

function setWaterGoal() {
  const g = Number(prompt('–¶–µ–ª—å –≤–æ–¥—ã (–º–ª)', goal));
  if (g) goal = g;
  updateWater();
}
updateWater();
</script>

</body>
</html>
