<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Fitness Mini App</title>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 10px;
      background: #f5f5f5;
    }

    .tabs {
      display: flex;
      justify-content: space-around;
      margin-bottom: 10px;
    }

    .tab {
      padding: 10px;
      background: #ddd;
      border-radius: 5px;
      cursor: pointer;
    }

    .tab.active {
      background: #4CAF50;
      color: white;
    }

    .section {
      display: none;
      background: white;
      padding: 10px;
      border-radius: 5px;
    }

    .section.active {
      display: block;
    }

    .food-item {
      margin-bottom: 8px;
      cursor: pointer;
    }

    .water-box {
      margin-top: 15px;
      padding-top: 10px;
      border-top: 1px solid #ccc;
    }

    button {
      padding: 5px 10px;
      margin-top: 5px;
    }

    .day {
      margin-bottom: 10px;
      cursor: pointer;
      background: #eee;
      padding: 8px;
      border-radius: 5px;
    }

    .exercise {
      margin-bottom: 10px;
    }
  </style>
</head>

<body>

<!-- –í–ö–õ–ê–î–ö–ò -->
<div class="tabs">
  <div class="tab active" onclick="openTab('food')">–ï–¥–∞</div>
  <div class="tab" onclick="openTab('workout')">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</div>
  <div class="tab" onclick="openTab('stats')">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
</div>

<!-- –ï–î–ê -->
<div id="food" class="section active">
  <h3>–ï–¥–∞ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</h3>

  <div class="food-item">
    <input type="checkbox" onchange="toggleFood('oatmeal')" id="oatmeal">
    <span onclick="openRecipe('–û–≤—Å—è–Ω–∫–∞')">–û–≤—Å—è–Ω–∫–∞ —Å –±–∞–Ω–∞–Ω–æ–º</span>
  </div>

  <div class="food-item">
    <input type="checkbox" onchange="toggleFood('chicken')" id="chicken">
    <span onclick="openRecipe('–ö—É—Ä–∏—Ü–∞')">–ö—É—Ä–∏—Ü–∞ —Å —Ä–∏—Å–æ–º</span>
  </div>

  <div class="food-item">
    <input type="checkbox" onchange="toggleFood('curd')" id="curd">
    <span onclick="openRecipe('–¢–≤–æ—Ä–æ–≥')">–¢–≤–æ—Ä–æ–≥</span>
  </div>

  <!-- –í–û–î–ê -->
  <div class="water-box">
    <h4>–í–æ–¥–∞</h4>
    <p>–¶–µ–ª—å: <b>2000 –º–ª</b></p>

    <input type="number" id="waterInput" placeholder="–°–∫–æ–ª—å–∫–æ –≤—ã–ø–∏–ª (–º–ª)">
    <button onclick="addWater()">+</button>

    <p>–í—ã–ø–∏—Ç–æ: <span id="waterDone">0</span> –º–ª</p>
    <p>–û—Å—Ç–∞–ª–æ—Å—å: <span id="waterLeft">2000</span> –º–ª</p>
  </div>
</div>
<!-- –¢–†–ï–ù–ò–†–û–í–ö–ò -->
<div id="workout" class="section">
  <h3>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h3>

  <div class="day" onclick="openDay('monday')">–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</div>
  <div class="day" onclick="openDay('wednesday')">–°—Ä–µ–¥–∞</div>
  <div class="day" onclick="openDay('friday')">–ü—è—Ç–Ω–∏—Ü–∞</div>
</div>

<!-- –î–ï–ù–¨ –¢–†–ï–ù–ò–†–û–í–ö–ò -->
<div id="day" class="section">
  <h3 id="dayTitle"></h3>

  <div class="exercise">
    –ñ–∏–º –ª—ë–∂–∞:
    <input type="number" id="bench">
    <button onclick="saveExercise('bench')">+</button>
  </div>

  <div class="exercise">
    –ü—Ä–∏—Å–µ–¥:
    <input type="number" id="squat">
    <button onclick="saveExercise('squat')">+</button>
  </div>

  <button onclick="resetDay()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å –¥–µ–Ω—å</button>
  <br><br>
  <button onclick="backToWorkout()">‚Üê –ù–∞–∑–∞–¥</button>
</div>


<!-- –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
<div id="stats" class="section">
  <h3>–í–µ—Å</h3>

  <input type="number" id="weightInput" placeholder="–í–µ—Å (–∫–≥)">
  <button onclick="saveWeight()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>

  <canvas id="weightChart" width="300" height="200" style="margin-top:15px;"></canvas>
</div>


<script>
// ===== –°–¢–ê–¢–ò–°–¢–ò–ö–ê –í–ï–°–ê =====

let weights = JSON.parse(localStorage.getItem('weights')) || [];

function saveWeight() {
  const value = Number(document.getElementById('weightInput').value);
  if (!value) return;

  const date = new Date().toLocaleDateString();

  weights.push({ date, value });
  localStorage.setItem('weights', JSON.stringify(weights));

  document.getElementById('weightInput').value = '';
  drawChart();
}

function drawChart() {
  const canvas = document.getElementById('weightChart');
  const ctx = canvas.getContext('2d');

  ctx.clearRect(0, 0, canvas.width, canvas.height);

  if (weights.length === 0) return;

  const values = weights.map(w => w.value);
  const min = Math.min(...values);
  const max = Math.max(...values);

  const padding = 20;
  const stepX = (canvas.width - padding * 2) / (weights.length - 1 || 1);

  ctx.beginPath();
  ctx.strokeStyle = '#4CAF50';

  weights.forEach((w, i) => {
    const x = padding + i * stepX;
    const y = canvas.height - padding -
      ((w.value - min) / (max - min || 1)) * (canvas.height - padding * 2);

    if (i === 0) ctx.moveTo(x, y);
    else ctx.lineTo(x, y);

    ctx.fillRect(x - 2, y - 2, 4, 4);
  });

  ctx.stroke();
}

drawChart();

// ===== –ï–î–ê: –°–û–•–†–ê–ù–ï–ù–ò–ï –ì–ê–õ–û–ß–ï–ö =====

function toggleFood(name) {
  const checked = document.getElementById(name).checked;
  localStorage.setItem('food_' + name, checked);
}

function loadFood() {
  const foods = ['oatmeal', 'chicken', 'curd'];

  foods.forEach(name => {
    const saved = localStorage.getItem('food_' + name);
    if (saved === 'true') {
      document.getElementById(name).checked = true;
    }
  });
}

loadFood();
Telegram.WebApp.ready();
  
const MY_ID = 1463723399; 

const user = Telegram.WebApp.initDataUnsafe.user;

if (!user || user.id !== MY_ID) {
  document.body.innerHTML = '‚õî –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω';
}


// –≤–∫–ª–∞–¥–∫–∏
function openTab(id) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  event.target.classList.add('active');
  document.getElementById(id).classList.add('active');
}

// –í–û–î–ê
let water = Number(localStorage.getItem('water')) || 0;
const waterGoal = 2000;

function updateWater() {
  waterDone.innerText = water;
  waterLeft.innerText = Math.max(waterGoal - water, 0);
}

function addWater() {
  const value = Number(waterInput.value);
  if (!value) return;
  water += value;
  localStorage.setItem('water', water);
  waterInput.value = '';
  updateWater();
}
updateWater();

// –†–ï–¶–ï–ü–¢–´
function openRecipe(name) {
  food.classList.remove('active');
  recipe.classList.add('active');

  recipeTitle.innerText = name;

  const recipes = {
    '–û–≤—Å—è–Ω–∫–∞': '–û–≤—Å—è–Ω–∫–∞ 60–≥\n–ë–∞–Ω–∞–Ω 100–≥\n–ú—ë–¥ 10–≥',
    '–ö—É—Ä–∏—Ü–∞': '–ö—É—Ä–∏—Ü–∞ 150–≥\n–†–∏—Å 100–≥\n–û–≤–æ—â–∏',
    '–¢–≤–æ—Ä–æ–≥': '–¢–≤–æ—Ä–æ–≥ 200–≥\n–Ø–≥–æ–¥—ã'
  };

  recipeText.innerText = recipes[name];
}

function backToFood() {
  recipe.classList.remove('active');
  food.classList.add('active');
}

// –¢–†–ï–ù–ò–†–û–í–ö–ò
let currentDay = '';

function openDay(day) {
  workout.classList.remove('active');
  dayDiv = document.getElementById('day');
  dayDiv.classList.add('active');
  currentDay = day;
  dayTitle.innerText = day;
}

function saveExercise(ex) {
  const value = document.getElementById(ex).value;
  if (!value) return;
  localStorage.setItem(currentDay + '_' + ex, value);
  alert('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!');
}

function backToWorkout() {
  day.classList.remove('active');
  workout.classList.add('active');
}
</script>

</body>
</html>

