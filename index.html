<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">

<meta name="viewport"
content="width=device-width, initial-scale=1.0,
maximum-scale=1.0, user-scalable=no">

<title>Fitness Mini App</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
*{box-sizing:border-box}
body{
margin:0;
font-family:Arial,sans-serif;
background:#f5f5f5;
}

.screen{
display:none;
position:fixed;
top:0;left:0;
width:100%;
height:100vh;
padding:16px;
background:#f5f5f5;
overflow-y:auto;
}
.screen.active{display:block}

h2,h3{margin-top:0}

.big-btn{
flex:1;
display:flex;
align-items:center;
justify-content:center;
font-size:24px;
background:#fff;
border-bottom:1px solid #ddd;
}

#home{
display:flex;
flex-direction:column;
}

.section{
background:#fff;
padding:10px;
border-radius:8px;
margin-bottom:12px;
}

.item{
display:flex;
align-items:center;
justify-content:space-between;
margin-bottom:6px;
}

.check{
width:26px;
height:26px;
accent-color:#4CAF50;
}

.plus{
font-size:28px;
cursor:pointer;
}

.progress{
height:14px;
background:#ddd;
border-radius:8px;
overflow:hidden;
margin-top:6px;
}
.progress div{
height:100%;
background:#4CAF50;
width:0%;
}

button{
padding:10px;
margin-top:8px;
width:100%;
}
</style>
</head>

<body>

<!-- –ì–õ–ê–í–ù–´–ô -->
<div id="home" class="screen active">
<div class="big-btn" onclick="open('food')">üçΩ –ï–î–ê</div>
<div class="big-btn" onclick="open('workout')">üèãÔ∏è –¢–†–ï–ù–ò–†–û–í–ö–ò</div>
<div class="big-btn" onclick="open('stats')">üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê</div>
</div>

<!-- –ï–î–ê -->
<div id="food" class="screen">
<h2>–ï–¥–∞</h2>

<div id="meals"></div>

<div class="section">
<h3>üíß –í–æ–¥–∞ <span onclick="editWater()">‚úèÔ∏è</span></h3>
<input type="number" id="waterInput" placeholder="–°–∫–æ–ª—å–∫–æ –≤—ã–ø–∏–ª (–º–ª)">
<div class="plus" onclick="addWater()">‚ûï</div>
<div class="progress"><div id="waterBar"></div></div>
<p>–í—ã–ø–∏—Ç–æ: <span id="waterDone">0</span> / <span id="waterGoal">2000</span> –º–ª</p>
<button onclick="resetWater()">–°–±—Ä–æ—Å–∏—Ç—å –≤–æ–¥—É</button>
</div>

<button onclick="open('home')">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<!-- –¢–†–ï–ù–ò–†–û–í–ö–ò -->
<div id="workout" class="screen">
<h2>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h2>
<div id="days"></div>
<button onclick="open('home')">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<!-- –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
<div id="stats" class="screen">
<h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
<p>–î–æ–±–∞–≤–∏–º –ø–æ–∑–∂–µ</p>
<button onclick="open('home')">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<script>
Telegram.WebApp.ready();
Telegram.WebApp.expand();

/* –ù–ê–í–ò–ì–ê–¶–ò–Ø */
function open(id){
document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
document.getElementById(id).classList.add('active');
}

/* ===== –ï–î–ê ===== */
const mealNames=['–ó–∞–≤—Ç—Ä–∞–∫','–û–±–µ–¥','–£–∂–∏–Ω'];

function loadMeals(){
meals.innerHTML='';
mealNames.forEach(m=>{
const data=JSON.parse(localStorage.getItem(m)||'[]');
let html=`<div class="section"><h3>${m} <span class="plus" onclick="addMeal('${m}')">Ôºã</span></h3>`;
data.forEach((item,i)=>{
html+=`
<div class="item">
<input type="checkbox" class="check" ${item.done?'checked':''}
onchange="toggleMeal('${m}',${i})">
<span onclick="editMeal('${m}',${i})">${item.name}</span>
</div>`;
});
html+='</div>';
meals.innerHTML+=html;
});
}

function addMeal(meal){
const name=prompt('–ù–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞');
if(!name)return;
const data=JSON.parse(localStorage.getItem(meal)||'[]');
data.push({name,done:false});
localStorage.setItem(meal,JSON.stringify(data));
loadMeals();
}

function editMeal(meal,i){
if(confirm('–£–¥–∞–ª–∏—Ç—å –±–ª—é–¥–æ?')){
const data=JSON.parse(localStorage.getItem(meal));
data.splice(i,1);
localStorage.setItem(meal,JSON.stringify(data));
loadMeals();
}
}

function toggleMeal(meal,i){
const data=JSON.parse(localStorage.getItem(meal));
data[i].done=!data[i].done;
localStorage.setItem(meal,JSON.stringify(data));
}

loadMeals();

/* ===== –í–û–î–ê ===== */
let water=Number(localStorage.getItem('water'))||0;
let goal=Number(localStorage.getItem('goal'))||2000;

function updateWater(){
waterDone.innerText=water;
waterGoal.innerText=goal;
waterBar.style.width=Math.min(water/goal*100,100)+'%';
}
function addWater(){
const v=Number(waterInput.value);
if(!v)return;
water+=v;
localStorage.setItem('water',water);
waterInput.value='';
updateWater();
}
function editWater(){
const g=prompt('–¶–µ–ª—å –≤–æ–¥—ã (–º–ª)',goal);
if(!g)return;
goal=Number(g);
localStorage.setItem('goal',goal);
updateWater();
}
function resetWater(){
water=0;
localStorage.setItem('water',0);
updateWater();
}
updateWater();

/* ===== –¢–†–ï–ù–ò–†–û–í–ö–ò ===== */
const days=['–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫','–°—Ä–µ–¥–∞','–ü—è—Ç–Ω–∏—Ü–∞'];

function loadDays(){
daysDiv=days.map(d=>{
const ex=JSON.parse(localStorage.getItem(d)||'[]');
let h=`<div class="section"><h3>${d} <span class="plus" onclick="addEx('${d}')">Ôºã</span></h3>`;
ex.forEach((e,i)=>{
h+=`<div>${e.name} (${e.sets} –ø–æ–¥—Ö–æ–¥–∞)</div>`;
});
return h+'</div>';
}).join('');
days.innerHTML=daysDiv;
}

function addEx(day){
const name=prompt('–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ');
const sets=prompt('–ü–æ–¥—Ö–æ–¥—ã');
if(!name||!sets)return;
const ex=JSON.parse(localStorage.getItem(day)||'[]');
ex.push({name,sets});
localStorage.setItem(day,JSON.stringify(ex));
loadDays();
}
loadDays();
</script>

</body>
</html>
