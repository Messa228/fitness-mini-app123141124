<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">

<!-- –ó–∞–ø—Ä–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Fitness Mini App</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f2f2f2;
}

/* ===== –≠–ö–†–ê–ù–´ ===== */
.screen {
  display: none;
  position: fixed;
  inset: 0;
  padding: 16px;
  overflow-y: auto;
  background: #f2f2f2;
}

.screen.active {
  display: block;
}

/* ===== –ì–õ–ê–í–ù–ê–Ø ===== */
#home {
  display: flex;
  flex-direction: column;
}

.home-btn {
  flex: 1;
  background: white;
  margin-bottom: 10px;
  border-radius: 12px;
  font-size: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

/* ===== –°–ï–ö–¶–ò–ò ===== */
.section {
  background: white;
  border-radius: 12px;
  padding: 12px;
  margin-bottom: 16px;
}

.section-title {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.plus {
  font-size: 28px;
  cursor: pointer;
}

/* ===== –ë–õ–Æ–î–ê ===== */
.food-item, .exercise-item {
  display: flex;
  align-items: center;
  margin-top: 10px;
}

.checkbox {
  width: 28px;
  height: 28px;
  margin-right: 10px;
}

/* ===== –í–û–î–ê ===== */
.progress {
  height: 14px;
  background: #ddd;
  border-radius: 10px;
  overflow: hidden;
  margin-top: 10px;
}

.progress-fill {
  height: 100%;
  width: 0%;
  background: #4caf50;
}

/* ===== –ö–ù–û–ü–ö–ò ===== */
button {
  width: 100%;
  padding: 12px;
  margin-top: 10px;
  font-size: 16px;
}
</style>
</head>

<body>

<!-- ===== HOME ===== -->
<div id="home" class="screen active">
  <div class="home-btn" onclick="openScreen('food')">üçΩ –ï–î–ê</div>
  <div class="home-btn" onclick="openScreen('workout')">üèãÔ∏è –¢–†–ï–ù–ò–†–û–í–ö–ò</div>
  <div class="home-btn" onclick="openScreen('stats')">üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê</div>
</div>

<!-- ===== –ï–î–ê ===== -->
<div id="food" class="screen">
  <h2>–ï–¥–∞</h2>

  <div id="foodSections"></div>

  <!-- –í–û–î–ê -->
  <div class="section">
    <div class="section-title">
      <h3>–í–æ–¥–∞</h3>
      <span class="plus" onclick="setWaterGoal()">‚úèÔ∏è</span>
    </div>

    <input type="number" id="waterInput" placeholder="–°–∫–æ–ª—å–∫–æ –≤—ã–ø–∏–ª (–º–ª)">
    <button onclick="addWater()">+</button>

    <p>–í—ã–ø–∏—Ç–æ: <span id="waterDone">0</span> –º–ª</p>
    <p>–û—Å—Ç–∞–ª–æ—Å—å: <span id="waterLeft">0</span> –º–ª</p>

    <div class="progress">
      <div id="waterBar" class="progress-fill"></div>
    </div>
  </div>

  <button onclick="openScreen('home')">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<!-- ===== –†–ï–î–ê–ö–¢–û–† –ë–õ–Æ–î–ê ===== -->
<div id="foodEditor" class="screen">
  <h2>–ë–ª—é–¥–æ</h2>

  <input id="foodName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞">
  <textarea id="foodComp" placeholder="–°–æ—Å—Ç–∞–≤ –∏ –≥—Ä–∞–º–º–æ–≤–∫–∏"></textarea>

  <button onclick="saveFood()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
  <button onclick="openScreen('food')">–û—Ç–º–µ–Ω–∞</button>
</div>

<!-- ===== –¢–†–ï–ù–ò–†–û–í–ö–ò ===== -->
<div id="workout" class="screen">
  <h2>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h2>
  <div id="workoutSections"></div>
  <button onclick="openScreen('home')">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<!-- ===== –†–ï–î–ê–ö–¢–û–† –£–ü–†–ê–ñ–ù–ï–ù–ò–Ø ===== -->
<div id="workoutEditor" class="screen">
  <h2>–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</h2>

  <input id="exName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è">
  <input id="exSets" type="number" placeholder="–ö–æ–ª-–≤–æ –ø–æ–¥—Ö–æ–¥–æ–≤">

  <button onclick="saveExercise()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
  <button onclick="openScreen('workout')">–û—Ç–º–µ–Ω–∞</button>
</div>

<!-- ===== –°–¢–ê–¢–ò–°–¢–ò–ö–ê ===== -->
<div id="stats" class="screen">
  <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
  <button onclick="openScreen('home')">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<script>
Telegram.WebApp.ready();

/* ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø ===== */
function openScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* ===== –ï–î–ê ===== */
const meals = ['–ó–∞–≤—Ç—Ä–∞–∫', '–û–±–µ–¥', '–£–∂–∏–Ω'];
let currentMeal = '';

function renderFood() {
  const box = document.getElementById('foodSections');
  box.innerHTML = '';

  meals.forEach(meal => {
    const items = JSON.parse(localStorage.getItem('food_' + meal)) || [];

    box.innerHTML += `
      <div class="section">
        <div class="section-title">
          <h3>${meal}</h3>
          <span class="plus" onclick="addFood('${meal}')">+</span>
        </div>
        ${items.map((f,i)=>`
          <div class="food-item">
            <input type="checkbox" class="checkbox">
            ${f.name}
          </div>
        `).join('')}
      </div>
    `;
  });
}

function addFood(meal) {
  currentMeal = meal;
  foodName.value = '';
  foodComp.value = '';
  openScreen('foodEditor');
}

function saveFood() {
  const list = JSON.parse(localStorage.getItem('food_' + currentMeal)) || [];
  list.push({ name: foodName.value, comp: foodComp.value });
  localStorage.setItem('food_' + currentMeal, JSON.stringify(list));
  renderFood();
  openScreen('food');
}

/* ===== –í–û–î–ê ===== */
let goal = Number(localStorage.getItem('waterGoal')) || 2000;
let water = Number(localStorage.getItem('water')) || 0;

function updateWater() {
  waterDone.textContent = water;
  waterLeft.textContent = Math.max(goal - water, 0);
  waterBar.style.width = Math.min(water / goal * 100, 100) + '%';
}

function addWater() {
  const v = Number(waterInput.value);
  if (!v) return;
  water += v;
  localStorage.setItem('water', water);
  waterInput.value = '';
  updateWater();
}

function setWaterGoal() {
  const g = prompt('–°–∫–æ–ª—å–∫–æ –≤–æ–¥—ã –≤ –¥–µ–Ω—å (–º–ª)?', goal);
  if (!g) return;
  goal = Number(g);
  localStorage.setItem('waterGoal', goal);
  updateWater();
}

/* ===== –¢–†–ï–ù–ò–†–û–í–ö–ò ===== */
const days = ['–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–°—Ä–µ–¥–∞', '–ü—è—Ç–Ω–∏—Ü–∞'];
let currentDay = '';

function renderWorkout() {
  const box = document.getElementById('workoutSections');
  box.innerHTML = '';

  days.forEach(day => {
    const ex = JSON.parse(localStorage.getItem('workout_' + day)) || [];

    box.innerHTML += `
      <div class="section">
        <div class="section-title">
          <h3>${day}</h3>
          <span class="plus" onclick="addExercise('${day}')">+</span>
        </div>
        ${ex.map(e=>`
          <div class="exercise-item">
            <input type="checkbox" class="checkbox">
            ${e.name} (${e.sets} –ø–æ–¥—Ö–æ–¥–æ–≤)
          </div>
        `).join('')}
      </div>
    `;
  });
}

function addExercise(day) {
  currentDay = day;
  exName.value = '';
  exSets.value = '';
  openScreen('workoutEditor');
}

function saveExercise() {
  const list = JSON.parse(localStorage.getItem('workout_' + currentDay)) || [];
  list.push({ name: exName.value, sets: exSets.value });
  localStorage.setItem('workout_' + currentDay, JSON.stringify(list));
  renderWorkout();
  openScreen('workout');
}

/* INIT */
renderFood();
renderWorkout();
updateWater();
</script>

</body>
</html>
