<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">

<meta name="viewport"
content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Fitness Mini App</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:#f5f5f5;
}

.screen{
  display:none;
  position:fixed;
  inset:0;
  padding:16px;
  background:#f5f5f5;
  overflow-y:auto;
}
.screen.active{display:block}

.home-btn{
  height:33.33vh;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:26px;
  background:white;
  border-bottom:1px solid #ddd;
  cursor:pointer;
}

.section{
  background:white;
  padding:12px;
  margin-bottom:16px;
  border-radius:10px;
}

.item{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px;
  border-bottom:1px solid #eee;
  cursor:pointer;
}

.big-check{
  width:26px;
  height:26px;
}

.plus{
  font-size:26px;
  text-align:center;
  cursor:pointer;
  padding:10px;
}

button{
  padding:10px;
  font-size:16px;
  margin-top:10px;
  width:100%;
}

.progress{
  height:14px;
  background:#ddd;
  border-radius:10px;
  overflow:hidden;
}
.progress div{
  height:100%;
  background:#4CAF50;
}
</style>
</head>

<body>

<!-- ============ HOME ============ -->
<div id="home" class="screen active">
  <div class="home-btn" onclick="openScreen('food')">üçΩ –ï–î–ê</div>
  <div class="home-btn" onclick="openScreen('workout')">üèãÔ∏è –¢–†–ï–ù–ò–†–û–í–ö–ò</div>
  <div class="home-btn" onclick="openScreen('stats')">üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê</div>
</div>

<!-- ============ FOOD ============ -->
<div id="food" class="screen">
  <h2>–ï–¥–∞</h2>

  <div id="meals"></div>

  <div class="section">
    <h3>üíß –í–æ–¥–∞ <span onclick="editWater()">‚úèÔ∏è</span></h3>
    <p>–¶–µ–ª—å: <span id="waterGoal">2000</span> –º–ª</p>
    <input type="number" id="waterInput" placeholder="–°–∫–æ–ª—å–∫–æ –≤—ã–ø–∏–ª">
    <button onclick="addWater()">+</button>
    <button onclick="removeWater()">‚àí</button>
    <p>–í—ã–ø–∏—Ç–æ: <span id="waterDone">0</span></p>
    <div class="progress"><div id="waterBar"></div></div>
  </div>

  <button onclick="goHome()">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<!-- ============ FOOD EDIT ============ -->
<div id="foodEdit" class="screen">
  <h2>–ë–ª—é–¥–æ</h2>
  <input id="foodName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
  <textarea id="foodComp" placeholder="–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –≥—Ä–∞–º–º–æ–≤–∫–∏"></textarea>
  <button onclick="saveFood()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
  <button onclick="deleteFood()">–£–¥–∞–ª–∏—Ç—å</button>
  <button onclick="openScreen('food')">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<!-- ============ WORKOUT ============ -->
<div id="workout" class="screen">
  <h2>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h2>
  <div id="days"></div>
  <button onclick="goHome()">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<!-- ============ WORKOUT EDIT ============ -->
<div id="workoutEdit" class="screen">
  <h2>–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</h2>
  <input id="exName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
  <input id="exSets" placeholder="–ü–æ–¥—Ö–æ–¥—ã">
  <button onclick="saveExercise()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
  <button onclick="deleteExercise()">–£–¥–∞–ª–∏—Ç—å</button>
  <button onclick="openScreen('workout')">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<!-- ============ STATS ============ -->
<div id="stats" class="screen">
  <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
  <button onclick="goHome()">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<script>
Telegram.WebApp.ready();

/* ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø ===== */
function openScreen(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}
function goHome(){openScreen('home')}

/* ===== –ï–î–ê ===== */
let currentFood=null;
let meals=JSON.parse(localStorage.getItem('meals'))||{
  breakfast:[],lunch:[],dinner:[]
};

function renderMeals(){
  mealsDiv.innerHTML='';
  for(let m in meals){
    let block=`<div class="section"><h3>${m}</h3>`;
    meals[m].forEach((f,i)=>{
      block+=`
      <div class="item" onclick="editFood('${m}',${i})">
        ${f.name}
        <input type="checkbox" class="big-check" ${f.done?'checked':''}>
      </div>`;
    });
    block+=`<div class="plus" onclick="newFood('${m}')">Ôºã</div></div>`;
    mealsDiv.innerHTML+=block;
  }
}
const mealsDiv=document.getElementById('meals');

function newFood(meal){
  currentFood={meal,index:null};
  foodName.value='';
  foodComp.value='';
  openScreen('foodEdit');
}
function editFood(meal,index){
  currentFood={meal,index};
  const f=meals[meal][index];
  foodName.value=f.name;
  foodComp.value=f.comp;
  openScreen('foodEdit');
}
function saveFood(){
  const f={name:foodName.value,comp:foodComp.value,done:false};
  if(currentFood.index==null) meals[currentFood.meal].push(f);
  else meals[currentFood.meal][currentFood.index]=f;
  localStorage.setItem('meals',JSON.stringify(meals));
  openScreen('food'); renderMeals();
}
function deleteFood(){
  meals[currentFood.meal].splice(currentFood.index,1);
  localStorage.setItem('meals',JSON.stringify(meals));
  openScreen('food'); renderMeals();
}
renderMeals();

/* ===== –í–û–î–ê ===== */
let water=Number(localStorage.getItem('water'))||0;
let goal=Number(localStorage.getItem('goal'))||2000;

function updateWater(){
  waterDone.innerText=water;
  waterGoal.innerText=goal;
  waterBar.style.width=Math.min(water/goal*100,100)+'%';
}
function addWater(){
  water+=Number(waterInput.value||0);
  localStorage.setItem('water',water);
  waterInput.value='';
  updateWater();
}
function removeWater(){
  water=Math.max(0,water-Number(waterInput.value||0));
  localStorage.setItem('water',water);
  updateWater();
}
function editWater(){
  const g=prompt('–¶–µ–ª—å –≤–æ–¥—ã (–º–ª)',goal);
  if(g){goal=Number(g);localStorage.setItem('goal',goal);updateWater();}
}
updateWater();
</script>

</body>
</html>
