<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">

<!-- –ó–ê–ü–†–ï–¢ –ú–ê–°–®–¢–ê–ë–ò–†–û–í–ê–ù–ò–Ø -->
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Fitness Mini App</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f5f5f5;
  overscroll-behavior: none;
}

/* ===== –≠–ö–†–ê–ù–´ ===== */
.screen {
  display: none;
  position: fixed;
  inset: 0;
  background: #f5f5f5;
  padding: 16px;
  overflow-y: auto;
}
.screen.active { display: block; }

h2, h3 { margin-top: 0; }

/* ===== –ì–õ–ê–í–ù–´–ô –≠–ö–†–ê–ù ===== */
#home {
  display: flex;
  flex-direction: column;
}
.home-btn {
  flex: 1;
  background: white;
  margin-bottom: 8px;
  border-radius: 12px;
  font-size: 26px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ===== –ö–ù–û–ü–ö–ò ===== */
button {
  padding: 10px;
  font-size: 16px;
  border-radius: 8px;
  border: none;
  margin-top: 8px;
}

/* ===== –ï–î–ê ===== */
.meal {
  background: white;
  padding: 12px;
  border-radius: 12px;
  margin-bottom: 12px;
}

.food-item {
  display: flex;
  align-items: center;
  margin-bottom: 8px;
}

.food-item input[type="checkbox"] {
  width: 28px;
  height: 28px;
  margin-right: 10px;
}

.add-box input, textarea {
  width: 100%;
  padding: 8px;
  margin-top: 6px;
  font-size: 16px;
}

/* ===== –¢–†–ï–ù–ò–†–û–í–ö–ò ===== */
.day {
  background: white;
  padding: 12px;
  border-radius: 12px;
  margin-bottom: 12px;
}

.sets {
  display: flex;
  gap: 8px;
  margin-top: 6px;
}
.sets input {
  width: 24px;
  height: 24px;
}
</style>
</head>

<body>

<!-- ================= HOME ================= -->
<div id="home" class="screen active">
  <div class="home-btn" onclick="openScreen('food')">üçΩ –ï–î–ê</div>
  <div class="home-btn" onclick="openScreen('workout')">üèãÔ∏è –¢–†–ï–ù–ò–†–û–í–ö–ò</div>
  <div class="home-btn" onclick="openScreen('stats')">üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê</div>
</div>

<!-- ================= –ï–î–ê ================= -->
<div id="food" class="screen">
<h2>–ï–¥–∞</h2>

<div id="meals"></div>

<div class="meal">
<h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ</h3>
<input id="foodName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
<textarea id="foodComp" placeholder="–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –≥—Ä–∞–º–º—ã"></textarea>
<select id="foodMeal">
  <option value="–ó–∞–≤—Ç—Ä–∞–∫">–ó–∞–≤—Ç—Ä–∞–∫</option>
  <option value="–û–±–µ–¥">–û–±–µ–¥</option>
  <option value="–£–∂–∏–Ω">–£–∂–∏–Ω</option>
</select>
<button onclick="addFood()">–î–æ–±–∞–≤–∏—Ç—å</button>
</div>

<button onclick="goHome()">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<!-- ================= –¢–†–ï–ù–ò–†–û–í–ö–ò ================= -->
<div id="workout" class="screen">
<h2>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h2>

<div id="days"></div>

<div class="day">
<h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</h3>
<input id="exName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
<input id="exSets" type="number" placeholder="–ü–æ–¥—Ö–æ–¥—ã">
<select id="exDay">
  <option value="–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫">–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</option>
  <option value="–°—Ä–µ–¥–∞">–°—Ä–µ–¥–∞</option>
  <option value="–ü—è—Ç–Ω–∏—Ü–∞">–ü—è—Ç–Ω–∏—Ü–∞</option>
</select>
<button onclick="addExercise()">–î–æ–±–∞–≤–∏—Ç—å</button>
</div>

<button onclick="goHome()">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<!-- ================= STATS ================= -->
<div id="stats" class="screen">
<h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
<p>–ë—É–¥–µ—Ç –ø–æ–∑–∂–µ</p>
<button onclick="goHome()">‚Üê –ù–∞–∑–∞–¥</button>
</div>

<script>
Telegram.WebApp.ready();

/* ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø ===== */
function openScreen(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}
function goHome(){ openScreen('home'); }

/* ===== –ï–î–ê ===== */
let foods = JSON.parse(localStorage.getItem('foods')||'[]');

function renderFood(){
  const meals = {–ó–∞–≤—Ç—Ä–∞–∫:[],–û–±–µ–¥:[],–£–∂–∏–Ω:[]};
  foods.forEach(f=>meals[f.meal].push(f));

  mealsDiv.innerHTML='';
  for(let m in meals){
    const div=document.createElement('div');
    div.className='meal';
    div.innerHTML=`<h3>${m}</h3>`;
    meals[m].forEach((f,i)=>{
      div.innerHTML+=`
      <div class="food-item">
        <input type="checkbox" ${f.done?'checked':''}
        onchange="toggleFood(${i})">
        <div>
          <b>${f.name}</b><br>
          <small>${f.comp}</small>
        </div>
      </div>`;
    });
    mealsDiv.appendChild(div);
  }
}

function addFood(){
  if(!foodName.value) return;
  foods.push({
    name:foodName.value,
    comp:foodComp.value,
    meal:foodMeal.value,
    done:false
  });
  localStorage.setItem('foods',JSON.stringify(foods));
  foodName.value=''; foodComp.value='';
  renderFood();
}

function toggleFood(i){
  foods[i].done=!foods[i].done;
  localStorage.setItem('foods',JSON.stringify(foods));
}

renderFood();

/* ===== –¢–†–ï–ù–ò–†–û–í–ö–ò ===== */
let exercises = JSON.parse(localStorage.getItem('ex')||'[]');

function renderEx(){
  const d={–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫:[],–°—Ä–µ–¥–∞:[],–ü—è—Ç–Ω–∏—Ü–∞:[]};
  exercises.forEach(e=>d[e.day].push(e));
  days.innerHTML='';
  for(let day in d){
    const div=document.createElement('div');
    div.className='day';
    div.innerHTML=`<h3>${day}</h3>`;
    d[day].forEach((e,i)=>{
      let done=e.done||0;
      let left=e.sets-done;
      div.innerHTML+=`
      <b>${e.name}</b> ‚Äî –û—Å—Ç–∞–ª–æ—Å—å ${left}
      <div class="sets">
        ${Array.from({length:e.sets}).map((_,s)=>`
        <input type="checkbox" ${s<done?'checked':''}
        onchange="toggleSet(${i},${s})">`).join('')}
      </div>`;
    });
    days.appendChild(div);
  }
}

function addExercise(){
  if(!exName.value||!exSets.value) return;
  exercises.push({
    name:exName.value,
    sets:+exSets.value,
    day:exDay.value,
    done:0
  });
  localStorage.setItem('ex',JSON.stringify(exercises));
  exName.value=''; exSets.value='';
  renderEx();
}

function toggleSet(i,s){
  exercises[i].done=s+1;
  localStorage.setItem('ex',JSON.stringify(exercises));
  renderEx();
}

renderEx();
</script>

</body>
</html>
